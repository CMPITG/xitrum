

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Writing POSTbacks &mdash; Xitrum v1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Xitrum v1.0 documentation" href="index.html" />
    <link rel="next" title="Validation" href="validation.html" />
    <link rel="prev" title="Writing RESTful APIs" href="restful.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="validation.html" title="Validation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="restful.html" title="Writing RESTful APIs"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Xitrum v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="writing-postbacks">
<h1>Writing POSTbacks<a class="headerlink" href="#writing-postbacks" title="Permalink to this headline">¶</a></h1>
<img alt="http://www.bdoubliees.com/journalspirou/sfigures6/schtroumpfs/s2.jpg" src="http://www.bdoubliees.com/journalspirou/sfigures6/schtroumpfs/s2.jpg" />
<p>Please see the following links for the idea about POSTback:</p>
<ul class="simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Postback">http://en.wikipedia.org/wiki/Postback</a></li>
<li><a class="reference external" href="http://nitrogenproject.com/doc/tutorial.html">http://nitrogenproject.com/doc/tutorial.html</a></li>
</ul>
<p>Xitrum supports Ajax form postback with additional features:</p>
<ul class="simple">
<li>Anti CSRF token, as in Rails</li>
<li>Validation, as in Nitrogen</li>
</ul>
<p>If you are loyal to this style, for web sites without APIs, you only need to
annotate GET routes. You only need to do SEO on GET routes because these are
the only pages that search engines follow.</p>
<div class="highlight-python"><pre>// first: This route will be matched before others, like /articles/:id
@GET(value="/articles/new", first=true)
class ArticleNewCreate extends Action {
  beforeFilters("authenticate") = () =&gt; session.contains("user")

  override def execute {
    renderView(
      &lt;form post2="submit" action={urlForPostback[ArticleCreate]}&gt;  &lt;-- The URL is encrypted, the encrypted URL acts like an anti CSRF token
        Title:
        {&lt;input type="text" name="title" /&gt;.validate(new Required)}&lt;br /&gt;

        Body:
        {textarea name="body"&gt;&lt;/textarea&gt;.validate(new Required)}&lt;br /&gt;

        &lt;input type="submit" value="OK" /&gt;
      &lt;/form&gt;
    )
  }

  override def postback {
    val title = param("title")
    val body  = param("body")
    val user  = session("user").asInstanceOf[User]

    Article.save(user.id, title, body)
    jsRedirectTo[ArticleIndex]
  }
}</pre>
</div>
<p>To make a postback, you need to know:</p>
<ul class="simple">
<li>The event that triggers postback</li>
<li>The element where the event occurs</li>
<li>The action destination on the server</li>
<li>Parameters to send with the postback</li>
</ul>
<div class="section" id="general-case">
<h2>General case<a class="headerlink" href="#general-case" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>&lt;tag1 id="form"&gt;
  &lt;!-- form elements in this tag will be posted back --&gt;
&lt;/tag1&gt;

&lt;tag2 postback="event" action="/url/to/action" form="form" /&gt;</pre>
</div>
</div>
<div class="section" id="special-case-1-action-is-the-same-with-the-current-page-url">
<h2>Special case 1: action is the same with the current page URL<a class="headerlink" href="#special-case-1-action-is-the-same-with-the-current-page-url" title="Permalink to this headline">¶</a></h2>
<p>You can leave out &#8220;action&#8221;.</p>
<div class="highlight-python"><pre>&lt;tag1 id="form"&gt;
  &lt;!-- form elements in this tag will be posted back --&gt;
&lt;/tag1&gt;

&lt;tag2 postback="event" form ="form" /&gt;</pre>
</div>
</div>
<div class="section" id="special-case-2-tag1-and-tag2-are-the-same">
<h2>Special case 2: tag1 and tag2 are the same<a class="headerlink" href="#special-case-2-tag1-and-tag2-are-the-same" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>&lt;tag1 postback="event" action="/url/to/action"&gt;
  &lt;!-- form elements in this tag will be posted back --&gt;
&lt;/tag1&gt;</pre>
</div>
</div>
<div class="section" id="special-case-3-combination-of-the-above">
<h2>Special case 3: combination of the above<a class="headerlink" href="#special-case-3-combination-of-the-above" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>&lt;tag1 postback="event"&gt;
  &lt;!-- form elements in this tag will be posted back --&gt;
&lt;/tag1&gt;</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Writing POSTbacks</a><ul>
<li><a class="reference internal" href="#general-case">General case</a></li>
<li><a class="reference internal" href="#special-case-1-action-is-the-same-with-the-current-page-url">Special case 1: action is the same with the current page URL</a></li>
<li><a class="reference internal" href="#special-case-2-tag1-and-tag2-are-the-same">Special case 2: tag1 and tag2 are the same</a></li>
<li><a class="reference internal" href="#special-case-3-combination-of-the-above">Special case 3: combination of the above</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="restful.html"
                        title="previous chapter">Writing RESTful APIs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="validation.html"
                        title="next chapter">Validation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/postback.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="validation.html" title="Validation"
             >next</a> |</li>
        <li class="right" >
          <a href="restful.html" title="Writing RESTful APIs"
             >previous</a> |</li>
        <li><a href="index.html">Xitrum v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Ngoc.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>